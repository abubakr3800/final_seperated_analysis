<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test JSON Sidebar</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* JSON Sidebar Styles */
        .json-toggle-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .json-toggle-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,123,255,0.4);
        }

        .json-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: #f8f9fa;
            border-left: 1px solid #dee2e6;
            z-index: 999;
            transition: right 0.3s ease;
            overflow-y: auto;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        }

        .json-sidebar.open {
            right: 0;
        }

        .json-sidebar-header {
            background: #007bff;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #0056b3;
        }

        .json-sidebar-header h5 {
            margin: 0;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .json-sidebar-header .btn-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .json-sidebar-header .btn-close:hover {
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
        }

        .json-sidebar-content {
            padding: 20px;
        }

        .json-content {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #4a5568;
        }

        .accordion-button {
            font-size: 0.9em;
            padding: 12px 15px;
        }

        .accordion-button:not(.collapsed) {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .accordion-body {
            padding: 15px;
        }

        /* Adjust main container when sidebar is open */
        .container.sidebar-open {
            margin-right: 400px;
            transition: margin-right 0.3s ease;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .json-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .container.sidebar-open {
                margin-right: 0;
            }
            
            .json-toggle-btn {
                top: 10px;
                right: 10px;
                padding: 10px 15px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- JSON Sidebar Toggle Button -->
    <button class="json-toggle-btn" id="jsonToggleBtn" onclick="toggleJsonSidebar()">
        <i class="bi bi-code-slash"></i>
        <span>JSON</span>
    </button>

    <!-- JSON Sidebar -->
    <div class="json-sidebar" id="jsonSidebar">
        <div class="json-sidebar-header">
            <h5><i class="bi bi-code-slash"></i> Raw JSON Data</h5>
            <button class="btn-close" onclick="toggleJsonSidebar()"></button>
        </div>
        <div class="json-sidebar-content">
            <div class="accordion" id="jsonAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#extractedDataCollapse" aria-expanded="false" aria-controls="extractedDataCollapse">
                            <i class="bi bi-file-earmark-text me-2"></i>Extracted Data
                        </button>
                    </h2>
                    <div id="extractedDataCollapse" class="accordion-collapse collapse" data-bs-parent="#jsonAccordion">
                        <div class="accordion-body">
                            <pre id="extractedJsonContent" class="json-content">No data available</pre>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#complianceDataCollapse" aria-expanded="false" aria-controls="complianceDataCollapse">
                            <i class="bi bi-check-circle me-2"></i>Compliance Data
                        </button>
                    </h2>
                    <div id="complianceDataCollapse" class="accordion-collapse collapse" data-bs-parent="#jsonAccordion">
                        <div class="accordion-body">
                            <pre id="complianceJsonContent" class="json-content">No data available</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="test-container" id="mainContainer">
        <h1>ðŸ§ª Test JSON Sidebar</h1>
        <p>This page demonstrates the new JSON sidebar functionality with Bootstrap accordion and collapsible sections.</p>
        
        <div class="row">
            <div class="col-md-6">
                <button class="btn btn-primary" onclick="loadSampleData()">Load Sample Data</button>
                <button class="btn btn-secondary" onclick="clearData()">Clear Data</button>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>Features:</h3>
            <ul>
                <li>âœ… <strong>Collapsible Sidebar</strong> - Slides in from the right</li>
                <li>âœ… <strong>Bootstrap Accordion</strong> - Organized sections for different data types</li>
                <li>âœ… <strong>Syntax Highlighting</strong> - Dark theme for JSON content</li>
                <li>âœ… <strong>Responsive Design</strong> - Works on mobile and desktop</li>
                <li>âœ… <strong>Default Collapsed</strong> - Accordion sections start collapsed</li>
                <li>âœ… <strong>Auto-scroll</strong> - JSON content is scrollable</li>
            </ul>
        </div>
        
        <div class="mt-4">
            <h3>Instructions:</h3>
            <ol>
                <li>Click the <strong>"JSON"</strong> button in the top-right corner</li>
                <li>The sidebar will slide in from the right</li>
                <li>Click on <strong>"Extracted Data"</strong> or <strong>"Compliance Data"</strong> to expand</li>
                <li>View the formatted JSON content</li>
                <li>Click the <strong>"X"</strong> button or <strong>"Close"</strong> to hide the sidebar</li>
            </ol>
        </div>
    </div>

    <script>
        // Sample data for testing
        const sampleExtractedData = {
            "metadata": {
                "company_name": "Test Company Ltd",
                "project_name": "Office Building Lighting Design",
                "engineer": "Eng. John Smith",
                "email": "john.smith@testcompany.com",
                "report_title": "Office_Lighting_Report.pdf"
            },
            "lighting_setup": {
                "number_of_fixtures": 24,
                "fixture_type": "LED Panel 40W",
                "mounting_height_m": 3.0,
                "average_lux": 500,
                "uniformity": 0.7,
                "total_power_w": 960,
                "luminous_efficacy_lm_per_w": 120
            },
            "luminaires": [
                {
                    "quantity": 24,
                    "manufacturer": "Philips",
                    "article_no": "CoreLine LED Panel 40W",
                    "power_w": 40,
                    "luminous_flux_lm": 4800,
                    "efficacy_lm_per_w": 120
                }
            ],
            "rooms": [
                {
                    "name": "Office Room 1",
                    "arrangement": "Grid",
                    "layout": [
                        {"x_m": 2.0, "y_m": 2.0, "z_m": 3.0},
                        {"x_m": 4.0, "y_m": 2.0, "z_m": 3.0},
                        {"x_m": 6.0, "y_m": 2.0, "z_m": 3.0}
                    ]
                }
            ],
            "scenes": [
                {
                    "scene_name": "General Office Work",
                    "average_lux": 500,
                    "min_lux": 300,
                    "max_lux": 700,
                    "uniformity": 0.7,
                    "utilisation_profile": "Office work - General"
                }
            ]
        };

        const sampleComplianceData = {
            "overall_compliance": "PASS",
            "summary": {
                "total_rooms": 2,
                "passed": 2,
                "failed": 0,
                "pass_rate": 100.0
            },
            "room_checks": [
                {
                    "room_name": "Office Room 1",
                    "status": "PASS",
                    "checks": {
                        "lux": {
                            "required": 300,
                            "actual": 500,
                            "status": "PASS"
                        },
                        "uniformity": {
                            "required": 0.6,
                            "actual": 0.7,
                            "status": "PASS"
                        }
                    }
                }
            ]
        };

        // JSON Sidebar Functions
        function toggleJsonSidebar() {
            const sidebar = document.getElementById('jsonSidebar');
            const container = document.getElementById('mainContainer');
            const toggleBtn = document.getElementById('jsonToggleBtn');
            
            if (sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
                container.classList.remove('sidebar-open');
                toggleBtn.innerHTML = '<i class="bi bi-code-slash"></i><span>JSON</span>';
            } else {
                sidebar.classList.add('open');
                container.classList.add('sidebar-open');
                toggleBtn.innerHTML = '<i class="bi bi-x-lg"></i><span>Close</span>';
            }
        }

        function updateJsonContent(extractedData, complianceData) {
            const extractedContent = document.getElementById('extractedJsonContent');
            const complianceContent = document.getElementById('complianceJsonContent');
            
            if (extractedData) {
                extractedContent.textContent = JSON.stringify(extractedData, null, 2);
            }
            
            if (complianceData) {
                complianceContent.textContent = JSON.stringify(complianceData, null, 2);
            }
        }

        function loadSampleData() {
            updateJsonContent(sampleExtractedData, sampleComplianceData);
            alert('Sample data loaded! Click the JSON button to view it.');
        }

        function clearData() {
            updateJsonContent(null, null);
            document.getElementById('extractedJsonContent').textContent = 'No data available';
            document.getElementById('complianceJsonContent').textContent = 'No data available';
            alert('Data cleared!');
        }
    </script>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

